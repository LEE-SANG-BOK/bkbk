version: "1.0"

# SSOT: “제출용 Asset Normalization” 기본 레시피(초안)
# - 원칙: DOCX에서 크롭/보정하지 않고, Normalize 단계에서 끝낸다.
# - 목적: 샘플(기허가) 수준의 “프레임(여백/테두리) + 워터마크 정책”을 일관되게 재현.
# - 주의: 이 파일은 ‘정답 데이터 생성/추정’을 포함하지 않음(가드레일). 제공된 첨부의 정리/표준화만 수행.

defaults:
  common:
    exif_fix: true
    autocrop:
      enabled: true
      edge_band_px: 30
      bg_percentile: 90
      diff_threshold: 15
      expand_px: 2
      min_area_ratio: 0.003
      morph_kernel: 3
      morph_iters: 1
    pad_px: 24
    border_px: 2
    border_rgb: [0, 0, 0]

  # 사진/스크린샷 등 raster 입력
  image:
    output_format: "PNG"     # 도면/텍스트 선명도 우선(선택: 사진은 JPEG 정책으로 분기 가능)
    optimize: true

  # PDF 도면(페이지 지정) 입력
  pdf:
    dpi: 250
    page_required: true
    output_format: "PNG"
    optimize: true

watermark:
  # authenticity=REFERENCE일 때 강제 적용(정책)
  reference:
    enabled: true
    text: "참고도(개략) - 공식 도면 아님"
    angle_deg: 32.0
    opacity: 0.18
    font_size: 42
    # (선택) 결정론적 폰트: 시스템 폴백으로 인한 PC별 출력 차이를 줄이기 위한 env var
    font_env_var: "EIA_GEN_WATERMARK_FONT_PATH"
  # authenticity=SSOT_SAMPLE일 때 적용(샘플 PDF 최대 재사용(B 방식)에서 미치환 페이지 식별/허위기재 방지)
  ssot_sample:
    enabled: true
    text: "SSOT 샘플(기허가) 참고용 - 치환 전 페이지"
    angle_deg: 32.0
    opacity: 0.16
    font_size: 42
    font_env_var: "EIA_GEN_WATERMARK_FONT_PATH"

constraints:
  # 실무지침 취지: 도면(A3 이하 권장) → “출력 폭/해상도” 과도 확대를 방지
  drawing:
    recommended_max_paper: "A3"
    note: "도면은 A3 이하 권장(실무 제출물 일관성/가독성). 출력 폭/해상도는 figure spec에서 clamp 권장."

materialize:
  # SSOT: “DOCX 삽입용(derived) raster” 레시피.
  # - 목적: DOCX 용량/속도 예측 가능(결정론) + 사진/도면 포맷 정책 고정.
  # - 우선순위: SSOT defaults → opts(MaterializeOptions) → gen_method override(FORMAT/DPI/MAX_WIDTH_PX/QUALITY).
  # - 주의: PDF는 기본적으로 PNG 렌더(선/문자 선명도), JPEG는 명시 override가 있을 때만 허용.
  defaults:
    target_dpi: 250
    max_width_px: 2600
    output_format: "PNG"
    jpeg_quality: 85

  # FIGURES.asset_type 기반 정책(“사진=JPEG(용량↓), 도면=PNG(선명)”)
  by_asset_type:
    # 사진류
    photo:
      output_format: "JPEG"
      target_dpi: 200
      max_width_px: 2400
      jpeg_quality: 85
    aerial_photo:
      output_format: "JPEG"
      target_dpi: 200
      max_width_px: 2400
      jpeg_quality: 85

    # 사진대지(텍스트/테두리 포함 가능) → PNG 유지(품질 우선)
    photo_sheet:
      output_format: "PNG"

    # 도면/지도류(선명도 우선)
    location_map:
      output_format: "PNG"
    landuse_plan:
      output_format: "PNG"
    layout_plan:
      output_format: "PNG"
    drainage_map:
      output_format: "PNG"
    influence_area_map:
      output_format: "PNG"
    eco_route_map:
      output_format: "PNG"
