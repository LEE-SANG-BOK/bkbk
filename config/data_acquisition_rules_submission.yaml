version: "1.0"

# 목적(Submission mode):
# - “혼자 제출본” 기준으로, case.xlsx(v2)의 핵심 누락을 WARN이 아니라 ERROR로 조기에 차단한다.
# - 본 파일은 기본 규칙(`config/data_acquisition_rules.yaml`)보다 더 엄격하며,
#   CLI에서 `--submission` 옵션으로 선택 적용한다.
#
# NOTE:
# - 일부 데이터(WMS/공공API)는 서비스별 승인/키 이슈로 자동수집이 막힐 수 있다.
#   이 경우에도 "빈칸 제출"을 막기 위해 ERROR로 남기고, fallback(공식 발급본 첨부/수기 입력)을 유도한다.

rules:
  # ---- 공통(지도/수집 기반) ----
  - id: LOC_MISSING_CENTER
    when:
      sheet: LOCATION
      column: center_lat
      is_empty: true
    severity: ERROR
    message: "LOCATION.center_lat/center_lon이 비어 있습니다(지도/WMS/API 수집 불가)."
    suggested_sources:
      - src_id: "SRC_SURVEY_ATTACHMENT"
        how: "측량성과/좌표 근거(PDF)를 첨부하고 LOCATION에 좌표 입력"
      - src_id: "SRC_GEOCODE_API"
        how: "주소 기반 지오코딩(옵션)으로 좌표 확보"

  - id: ZONING_OVERLAY_EMPTY
    when:
      sheet: ZONING_OVERLAY
      row_count: 0
      any_of: [is_applicable, distance_m, direction, basis]
    severity: ERROR
    message: "ZONING_OVERLAY이 비어 있습니다(규제/보호구역 해당여부/거리 표 누락)."
    suggested_sources:
      - src_id: "SRC_VWORLD_WMTS"
        how: "발급본/토지이용계획확인서 첨부(공식 근거) 또는 WMS/AUTO_GIS 기반 자동 채움(가능한 경우)"

  # ---- EIA 핵심(제출 체감에 직접 영향) ----
  - id: ENV_SCOPING_EMPTY
    when:
      sheet: ENV_SCOPING
      row_count: 0
    severity: ERROR
    message: "ENV_SCOPING이 비어 있습니다(평가항목 선정/제외 사유 누락)."
    suggested_sources:
      - src_id: "SRC_GUIDELINE"
        how: "평가서 작성지침/협의지침 근거로 항목별 선정/제외 사유를 기입"

  - id: ENV_MITIGATION_EMPTY
    when:
      sheet: ENV_MITIGATION
      row_count: 0
    severity: ERROR
    message: "ENV_MITIGATION이 비어 있습니다(공사/운영 단계 저감대책 누락)."
    suggested_sources:
      - src_id: "SRC_CONSTRUCTION_PLAN"
        how: "시공계획서/관리계획서 기반으로 단계별 대책을 행 단위로 입력"

  - id: ENV_MANAGEMENT_EMPTY
    when:
      sheet: ENV_MANAGEMENT
      row_count: 0
    severity: ERROR
    message: "ENV_MANAGEMENT이 비어 있습니다(협의조건 이행관리표 누락)."
    suggested_sources:
      - src_id: "SRC_REVIEW_CONDITIONS"
        how: "협의의견/조건 원문을 행별로 입력하고 이행계획/증빙을 연결"

  - id: AIR_BASELINE_EMPTY
    when:
      sheet: ENV_BASE_AIR
      row_count: 0
    severity: ERROR
    message: "ENV_BASE_AIR이 비어 있습니다(EIA 대기현황 근거 부족)."
    suggested_sources:
      - src_id: "SRC_AIRKOREA_API"
        how: "DATA_REQUESTS(AIRKOREA) 자동 수집 또는 수기 입력"

  - id: WATER_BASELINE_EMPTY
    when:
      sheet: ENV_BASE_WATER
      row_count: 0
    severity: ERROR
    message: "ENV_BASE_WATER가 비어 있습니다(EIA 수환경/수질 현황 근거 부족)."
    suggested_sources:
      - src_id: "SRC_NIER_WATER_API"
        how: "DATA_REQUESTS(NIER_WATER) 또는 수질측정망/문헌 기반 수기 입력"

  - id: NOISE_BASELINE_EMPTY
    when:
      sheet: ENV_BASE_NOISE
      row_count: 0
    severity: ERROR
    message: "ENV_BASE_NOISE가 비어 있습니다(EIA 소음·진동 현황 근거 부족)."
    suggested_sources:
      - src_id: "SRC_NOISE_REPORT"
        how: "측정결과(원시자료/보고서) 또는 문헌 근거를 첨부하고 대표 지점 값을 입력"

  - id: GEO_BASELINE_EMPTY
    when:
      sheet: ENV_BASE_GEO
      row_count: 0
    severity: ERROR
    message: "ENV_BASE_GEO가 비어 있습니다(EIA 지형·지질/토양 현황 근거 부족)."
    suggested_sources:
      - src_id: "SRC_GEOLOGY_REFERENCE"
        how: "지질도/토양도/문헌 또는 공식 발급본을 근거로 topic별 요약을 입력"

  - id: SOCIO_STATS_EMPTY
    when:
      sheet: ENV_BASE_SOCIO
      row_count: 0
    severity: ERROR
    message: "ENV_BASE_SOCIO가 비어 있습니다(인구/세대/주택 통계 근거 부족)."
    suggested_sources:
      - src_id: "SRC_KOSIS_API"
        how: "DATA_REQUESTS(KOSIS) 자동 수집(설정 필요) 또는 통계자료 기반 수기 입력"

  - id: ECO_EVENTS_EMPTY
    when:
      sheet: ENV_ECO_EVENTS
      row_count: 0
      any_of: [date, area_desc, evidence_id]
    severity: ERROR
    message: "ENV_ECO_EVENTS가 비어 있습니다(생태 조사 이벤트/시기 정보가 누락됨)."
    suggested_sources:
      - src_id: "SRC_ECO_SURVEY"
        how: "현장조사 기록(조사일/조사구간/날씨) 또는 조사보고서 기반으로 입력"

  - id: ECO_OBS_EMPTY
    when:
      sheet: ENV_ECO_OBS
      row_count: 0
      any_of: [taxon_group, scientific_name, korean_name]
    severity: ERROR
    message: "ENV_ECO_OBS가 비어 있습니다(생태 관찰(종/개체수) 근거가 누락됨)."
    suggested_sources:
      - src_id: "SRC_ECO_SURVEY"
        how: "조사 결과(종/개체수/보호종 여부) 입력 + 증빙(사진/조사표) 첨부"

  - id: LANDSCAPE_EMPTY
    when:
      sheet: ENV_LANDSCAPE
      row_count: 0
      any_of: [viewpoint_name, lat, lon, description, photo_fig_id, simulation_fig_id]
    severity: ERROR
    message: "ENV_LANDSCAPE가 비어 있습니다(조망점/경관 현황 근거가 누락될 수 있음)."
    suggested_sources:
      - src_id: "SRC_FIELD_PHOTOS"
        how: "조망점 사진(현장사진대지) + 좌표/설명 입력"
